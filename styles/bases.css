@layer base {
  html {
    /* スクロール時の挙動 */
    scroll-behavior: smooth;
    scroll-padding-top: 1rem;
    /* フォントサイズ */
    font-size: calc(18px * var(--size-scale, 1));
  }

  body {
    /* 文字間隔 */
    letter-spacing: 0.01em;
    line-height: 1.8;
  }

  /* スクロールでのリロードを無効化 */
  html,
  body {
    overscroll-behavior-y: none;
  }

  /* ボタン */
  button:not(:disabled),
  [role="button"]:not(:disabled) {
    /* ホバー時のカーソル */
    cursor: pointer;
  }

  /* クリック可能要素 - 非活性状態 */
  button:disabled,
  [role="button"]:disabled,
  a:disabled,
  input:disabled,
  select:disabled,
  textarea:disabled {
    cursor: not-allowed;
    opacity: 0.4;
    box-shadow: none;
    background-color: var(--color-outline);
    border-color: var(--color-secondary);
    color: var(--color-secondary);
  }

  /* クリック可能要素　- 最小サイズ */
  button,
  [role="button"]:not(.no-min-size),
  a,
  input[type="button"],
  input[type="submit"],
  input[type="reset"],
  select {
    min-height: 48px;
    min-width: 48px;
  }

  /* テキストリンク - 垂直方向の余白調整 */
  a:not(.inline-link),
  button:not(.inline-button) {
    padding-top: 0.5rem;
    padding-bottom: 0.5rem;
  }

  /* テキスト入力系 - 最小サイズと余白指定 */
  input:not([type="checkbox"]):not([type="radio"]),
  textarea {
    min-height: 48px;
    padding: 0.75rem 1rem;
    border-radius: 0.375rem;
    border: 1px solid var(--color-outline);
  }

  /* 強調表示 */
  strong {
    font-weight: 800;
  }

  /* ユーザー選択無効 */
  label {
    user-select: none;
  }

  /* スクロールバー */
  ::-webkit-scrollbar {
    width: 0.5rem;
    height: 0.5rem;
  }

  ::-webkit-scrollbar-thumb {
    background: var(--color-secondary);
    border-radius: 6px;
    border: 2px solid transparent;
    background-clip: padding-box;
  }

  ::-webkit-scrollbar-thumb:hover {
    background: var(--color-primary);
    border: 2px solid transparent;
    background-clip: padding-box;
  }

  ::-webkit-scrollbar-corner {
    background: transparent;
  }

  /* フォーカス状態強化 */
  a:focus-visible,
  button:focus-visible,
  input:focus-visible,
  select:focus-visible,
  textarea:focus-visible,
  [role="button"]:focus-visible,
  [tabindex]:focus-visible {
    @apply outline-none ring-3 ring-focus ring-offset-2;
  }

  /* 高コントラスト - フォーカス状態強化 */
  [data-contrast="High"] a:focus-visible,
  [data-contrast="High"] button:focus-visible,
  [data-contrast="High"] input:focus-visible,
  [data-contrast="High"] select:focus-visible,
  [data-contrast="High"] textarea:focus-visible,
  [data-contrast="High"] [role="button"]:focus-visible,
  [data-contrast="High"] [tabindex]:focus-visible {
    @apply ring-4 ring-offset-4;
  }

  /* フィードバック */
  .border-error,
  .border-success {
    @apply border-2!;
  }

  .text-error,
  .text-success {
    @apply font-semibold!;
  }

  /* 高コントラスト - フィードバック */
  [data-contrast="High"] .border-error,
  [data-contrast="High"] .border-success {
    @apply border-3!;
  }

  [data-contrast="High"] .text-error,
  [data-contrast="High"] .text-success {
    @apply font-bold!;
  }

  /* 動きを減らす設定がある場合はスムーズスクロールを無効化 */
  @media (prefers-reduced-motion: reduce) {
    html {
      scroll-behavior: auto;
    }
  }

  /* モバイルサイズ */
  @media (max-width: 768px) {
    /* 最小サイズ */
    button,
    [role="button"],
    a,
    input[type="button"],
    input[type="submit"],
    input[type="reset"],
    select {
      min-height: 56px;
      min-width: 56px;
    }

    /* フォーム要素サイズ拡大 */
    input:not([type="checkbox"]):not([type="radio"]),
    textarea {
      min-height: 56px;
      padding: 0.875rem 1.25rem;
    }
  }

  /* PWA */
  @media (display-mode: browser), (display-mode: standalone),
    (display-mode: minimal-ui), (display-mode: fullscreen) {
    header {
      padding-left: env(safe-area-inset-left);
      padding-right: env(safe-area-inset-right);
    }

    main {
      padding-left: calc(env(safe-area-inset-left) + 1rem) !important;
      padding-right: calc(env(safe-area-inset-right) + 1rem) !important;
      margin-bottom: env(safe-area-inset-bottom);
    }

    .fullscreen {
      padding-left: env(safe-area-inset-left);
      padding-right: env(safe-area-inset-right);
    }

    @media (min-width: 768px) {
      main {
        padding-left: calc(env(safe-area-inset-left) + 1.5rem) !important;
        padding-right: calc(env(safe-area-inset-right) + 1.5rem) !important;
      }
    }

    @media (min-width: 1024px) {
      main {
        padding-left: calc(env(safe-area-inset-left) + 2rem) !important;
        padding-right: calc(env(safe-area-inset-right) + 2rem) !important;
      }
    }

    footer {
      padding-left: env(safe-area-inset-left);
      padding-right: env(safe-area-inset-right);
      padding-bottom: max(env(safe-area-inset-bottom), 0.5rem);
    }
  }
}
